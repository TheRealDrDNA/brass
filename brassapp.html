<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brass Build Assistant</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: white;
            color: black;
            margin: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
            /* Optimized for profile view [cite: 2] */
        }

        #content-area {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 30px;
            text-align: center;
            font-size: 1.5rem;
            font-weight: 500;
            /* Black text on white background  */
        }

        #button-container {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            /* Positioned where right thumb can reach  */
            padding-bottom: 40px; 
        }

        button {
            padding: 16px;
            font-size: 1.1rem;
            border: 2px solid black;
            background: white;
            color: black;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: background 0.1s;
        }

        button:active {
            background: #eee;
        }

        .secondary-btns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 10px;
        }

        .nav-btn {
            background: #f0f0f0;
            font-size: 0.9rem;
            padding: 10px;
        }
    </style>
</head>
<body>

    <div id="content-area">
        <div id="question-text">Loading...</div>
    </div>

    <div id="button-container">
        <div id="choice-buttons"></div>
        <div class="secondary-btns">
            <button class="nav-btn" onclick="goBack()">← Back</button>
            <button class="nav-btn" onclick="resetApp()">Reset ⟳</button>
        </div>
    </div>

    <script>
        // Decision tree data based on 
        const nodes = {
            1: {
                text: "Does the city you want to build in have a space for it?",
                choices: [
                    { text: "Yes", next: 2 },
                    { text: "No", next: "fail_no_space" }
                ]
            },
            2: {
                text: "Is this the CANAL ERA?",
                choices: [
                    { text: "Yes (Canal Era)", next: 2.1 },
                    { text: "No (Rail Era)", next: 3 }
                ]
            },
            2.1: {
                text: "Would this be your ONLY building in this city?",
                choices: [
                    { text: "Yes", next: 3 },
                    { text: "No", next: "fail_canal_limit" }
                ]
            },
            3: {
                text: "Do you have a CITY card for that city?",
                choices: [
                    { text: "Yes", next: 6 },
                    { text: "No", next: 4 }
                ]
            },
            4: {
                text: "Do you have the appropriate INDUSTRY card?",
                choices: [
                    { text: "Yes", next: 5 },
                    { text: "No", next: "fail_no_card" }
                ]
            },
            5: {
                text: "Is the city in your NETWORK? (Cities with your buildings or adjacent links)",
                choices: [
                    { text: "Yes", next: 6 },
                    { text: "No", next: "fail_network" }
                ]
            },
            6: {
                text: "What resource does the building require?",
                choices: [
                    { text: "Coal", next: 7 },
                    { text: "Iron", next: 8 },
                    { text: "No Resource", next: 10 }
                ]
            },
            7: {
                text: "Is the city CONNECTED to a source of coal (mine or market)?",
                choices: [
                    { text: "Yes", next: 9 },
                    { text: "No", next: "fail_no_coal" }
                ]
            },
            8: {
                text: "SUCCESS: Place building & remove iron cubes. Locations don't need to be connected. Buy from market if needed.",
                choices: []
            },
            9: {
                text: "SUCCESS: Place building & remove coal from nearest connected mine (any player). Buy from market if connected.",
                choices: []
            },
            10: {
                text: "SUCCESS: You may place the building.",
                choices: []
            },
            // Failure states [cite: 8, 10, 17, 20, 27]
            "fail_no_space": { text: "You can't build it. No space available.", choices: [] },
            "fail_canal_limit": { text: "You can't build it. In the CANAL era, each player may only have one building per city.", choices: [] },
            "fail_no_card": { text: "You can't build it. You must have at least the proper CITY or INDUSTRY card.", choices: [] },
            "fail_network": { text: "You can't build it. You can only use an INDUSTRY CARD for a city in your NETWORK.", choices: [] },
            "fail_no_coal": { text: "You can't build it. No connected coal source.", choices: [] }
        };

        let history = [];
        let currentNode = 1;

        function renderNode() {
            const node = nodes[currentNode];
            document.getElementById('question-text').innerText = node.text;
            const container = document.getElementById('choice-buttons');
            container.innerHTML = '';

            node.choices.forEach(choice => {
                const btn = document.createElement('button');
                btn.innerText = choice.text;
                btn.onclick = () => {
                    triggerHaptic();
                    history.push(currentNode);
                    currentNode = choice.next;
                    renderNode();
                };
                container.appendChild(btn);
            });
        }

        function triggerHaptic() {
            // 
            if (window.navigator.vibrate) {
                window.navigator.vibrate(50);
            }
        }

        function goBack() {
            if (history.length > 0) {
                triggerHaptic();
                currentNode = history.pop();
                renderNode();
            }
        }

        function resetApp() {
            triggerHaptic();
            history = [];
            currentNode = 1;
            renderNode();
        }

        // Initialize
        renderNode();
    </script>
</body>
</html>
